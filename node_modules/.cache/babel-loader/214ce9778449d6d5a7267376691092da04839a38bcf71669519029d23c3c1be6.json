{"ast":null,"code":"import { isValidDomain } from './isValidDomain.js';\nimport { WebAuthnError } from './webAuthnError.js';\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.create()`\n */\nexport function identifyRegistrationError({\n  error,\n  options\n}) {\n  const {\n    publicKey\n  } = options;\n  if (!publicKey) {\n    throw Error('options was missing required publicKey property');\n  }\n  if (error.name === 'AbortError') {\n    if (options.signal instanceof AbortSignal) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n      return new WebAuthnError({\n        message: 'Registration ceremony was sent an abort signal',\n        code: 'ERROR_CEREMONY_ABORTED',\n        cause: error\n      });\n    }\n  } else if (error.name === 'ConstraintError') {\n    if (publicKey.authenticatorSelection?.requireResidentKey === true) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 4)\n      return new WebAuthnError({\n        message: 'Discoverable credentials were required but no available authenticator supported it',\n        code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',\n        cause: error\n      });\n    } else if (\n    // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024\n    options.mediation === 'conditional' && publicKey.authenticatorSelection?.userVerification === 'required') {\n      // https://w3c.github.io/webauthn/#sctn-createCredential (Step 22.4)\n      return new WebAuthnError({\n        message: 'User verification was required during automatic registration but it could not be performed',\n        code: 'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',\n        cause: error\n      });\n    } else if (publicKey.authenticatorSelection?.userVerification === 'required') {\n      // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 5)\n      return new WebAuthnError({\n        message: 'User verification was required but no available authenticator supported it',\n        code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',\n        cause: error\n      });\n    }\n  } else if (error.name === 'InvalidStateError') {\n    // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 20)\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 3)\n    return new WebAuthnError({\n      message: 'The authenticator was previously registered',\n      code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',\n      cause: error\n    });\n  } else if (error.name === 'NotAllowedError') {\n    /**\n     * Pass the error directly through. Platforms are overloading this error beyond what the spec\n     * defines and we don't want to overwrite potentially useful error messages.\n     */\n    return new WebAuthnError({\n      message: error.message,\n      code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n      cause: error\n    });\n  } else if (error.name === 'NotSupportedError') {\n    const validPubKeyCredParams = publicKey.pubKeyCredParams.filter(param => param.type === 'public-key');\n    if (validPubKeyCredParams.length === 0) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 10)\n      return new WebAuthnError({\n        message: 'No entry in pubKeyCredParams was of type \"public-key\"',\n        code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',\n        cause: error\n      });\n    }\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 2)\n    return new WebAuthnError({\n      message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',\n      code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',\n      cause: error\n    });\n  } else if (error.name === 'SecurityError') {\n    const effectiveDomain = globalThis.location.hostname;\n    if (!isValidDomain(effectiveDomain)) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 7)\n      return new WebAuthnError({\n        message: `${globalThis.location.hostname} is an invalid domain`,\n        code: 'ERROR_INVALID_DOMAIN',\n        cause: error\n      });\n    } else if (publicKey.rp.id !== effectiveDomain) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 8)\n      return new WebAuthnError({\n        message: `The RP ID \"${publicKey.rp.id}\" is invalid for this domain`,\n        code: 'ERROR_INVALID_RP_ID',\n        cause: error\n      });\n    }\n  } else if (error.name === 'TypeError') {\n    if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n      // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 5)\n      return new WebAuthnError({\n        message: 'User ID was not between 1 and 64 characters',\n        code: 'ERROR_INVALID_USER_ID_LENGTH',\n        cause: error\n      });\n    }\n  } else if (error.name === 'UnknownError') {\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 1)\n    // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 8)\n    return new WebAuthnError({\n      message: 'The authenticator was unable to process the specified options, or could not create a new credential',\n      code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n      cause: error\n    });\n  }\n  return error;\n}","map":{"version":3,"names":["isValidDomain","WebAuthnError","identifyRegistrationError","error","options","publicKey","Error","name","signal","AbortSignal","message","code","cause","authenticatorSelection","requireResidentKey","mediation","userVerification","validPubKeyCredParams","pubKeyCredParams","filter","param","type","length","effectiveDomain","globalThis","location","hostname","rp","id","user","byteLength"],"sources":["/Users/rohit/Desktop/projects/FinVote/node_modules/@simplewebauthn/browser/esm/helpers/identifyRegistrationError.js"],"sourcesContent":["import { isValidDomain } from './isValidDomain.js';\nimport { WebAuthnError } from './webAuthnError.js';\n/**\n * Attempt to intuit _why_ an error was raised after calling `navigator.credentials.create()`\n */\nexport function identifyRegistrationError({ error, options, }) {\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal instanceof AbortSignal) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 16)\n            return new WebAuthnError({\n                message: 'Registration ceremony was sent an abort signal',\n                code: 'ERROR_CEREMONY_ABORTED',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'ConstraintError') {\n        if (publicKey.authenticatorSelection?.requireResidentKey === true) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 4)\n            return new WebAuthnError({\n                message: 'Discoverable credentials were required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT',\n                cause: error,\n            });\n        }\n        else if (\n        // @ts-ignore: `mediation` doesn't yet exist on CredentialCreationOptions but it's possible as of Sept 2024\n        options.mediation === 'conditional' &&\n            publicKey.authenticatorSelection?.userVerification === 'required') {\n            // https://w3c.github.io/webauthn/#sctn-createCredential (Step 22.4)\n            return new WebAuthnError({\n                message: 'User verification was required during automatic registration but it could not be performed',\n                code: 'ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE',\n                cause: error,\n            });\n        }\n        else if (publicKey.authenticatorSelection?.userVerification === 'required') {\n            // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 5)\n            return new WebAuthnError({\n                message: 'User verification was required but no available authenticator supported it',\n                code: 'ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'InvalidStateError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 20)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 3)\n        return new WebAuthnError({\n            message: 'The authenticator was previously registered',\n            code: 'ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotAllowedError') {\n        /**\n         * Pass the error directly through. Platforms are overloading this error beyond what the spec\n         * defines and we don't want to overwrite potentially useful error messages.\n         */\n        return new WebAuthnError({\n            message: error.message,\n            code: 'ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY',\n            cause: error,\n        });\n    }\n    else if (error.name === 'NotSupportedError') {\n        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter((param) => param.type === 'public-key');\n        if (validPubKeyCredParams.length === 0) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 10)\n            return new WebAuthnError({\n                message: 'No entry in pubKeyCredParams was of type \"public-key\"',\n                code: 'ERROR_MALFORMED_PUBKEYCREDPARAMS',\n                cause: error,\n            });\n        }\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 2)\n        return new WebAuthnError({\n            message: 'No available authenticator supported any of the specified pubKeyCredParams algorithms',\n            code: 'ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG',\n            cause: error,\n        });\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = globalThis.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 7)\n            return new WebAuthnError({\n                message: `${globalThis.location.hostname} is an invalid domain`,\n                code: 'ERROR_INVALID_DOMAIN',\n                cause: error,\n            });\n        }\n        else if (publicKey.rp.id !== effectiveDomain) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 8)\n            return new WebAuthnError({\n                message: `The RP ID \"${publicKey.rp.id}\" is invalid for this domain`,\n                code: 'ERROR_INVALID_RP_ID',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'TypeError') {\n        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n            // https://www.w3.org/TR/webauthn-2/#sctn-createCredential (Step 5)\n            return new WebAuthnError({\n                message: 'User ID was not between 1 and 64 characters',\n                code: 'ERROR_INVALID_USER_ID_LENGTH',\n                cause: error,\n            });\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 1)\n        // https://www.w3.org/TR/webauthn-2/#sctn-op-make-cred (Step 8)\n        return new WebAuthnError({\n            message: 'The authenticator was unable to process the specified options, or could not create a new credential',\n            code: 'ERROR_AUTHENTICATOR_GENERAL_ERROR',\n            cause: error,\n        });\n    }\n    return error;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}